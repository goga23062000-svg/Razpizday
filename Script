-- Free Camera Script for Roblox
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- Configuration
local cameraSpeed = 10
local fastCameraSpeed = 25
local mouseSensitivity = 0.5

-- Camera state
local freeCameraEnabled = false
local cameraPosition = Vector3.new(0, 0, 0)
local cameraRotation = Vector2.new(0, 0)
local originalCameraType = Enum.CameraType.Custom

-- UI Elements
local screenGui
local toggleButton

-- Create the user interface
function createUI()
    if screenGui then
        screenGui:Destroy()
    end
    
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "FreeCameraUI"
    screenGui.Parent = player.PlayerGui
    screenGui.ResetOnSpawn = false
    
    toggleButton = Instance.new("TextButton")
    toggleButton.Name = "ToggleButton"
    toggleButton.Size = UDim2.new(0, 150, 0, 40)
    toggleButton.Position = UDim2.new(0, 20, 0, 20)
    toggleButton.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
    toggleButton.BorderSizePixel = 0
    toggleButton.Text = "FREE CAMERA"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.TextSize = 16
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.ZIndex = 10
    toggleButton.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = toggleButton
    
    local shadow = Instance.new("UIStroke")
    shadow.Color = Color3.fromRGB(40, 40, 60)
    shadow.Thickness = 2
    shadow.Parent = toggleButton
    
    toggleButton.MouseButton1Click:Connect(function()
        toggleFreeCamera()
    end)
    
    toggleButton.MouseEnter:Connect(function()
        if not freeCameraEnabled then
            TweenService:Create(toggleButton, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(100, 160, 210)
            }):Play()
        end
    end)
    
    toggleButton.MouseLeave:Connect(function()
        if not freeCameraEnabled then
            TweenService:Create(toggleButton, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(70, 130, 180)
            }):Play()
        end
    end)
end

-- Toggle free camera on/off
function toggleFreeCamera()
    freeCameraEnabled = not freeCameraEnabled
    
    if freeCameraEnabled then
        originalCameraType = camera.CameraType
        
        cameraPosition = camera.CFrame.Position
        cameraRotation = Vector2.new(
            math.atan2(camera.CFrame.LookVector.Z, camera.CFrame.LookVector.X),
            math.asin(camera.CFrame.LookVector.Y)
        )
        
        camera.CameraType = Enum.CameraType.Scriptable
        
        toggleButton.BackgroundColor3 = Color3.fromRGB(50, 180, 100)
        toggleButton.Text = "FREE CAMERA [ON]"
        
        UserInputService.MouseBehavior = Enum.MouseBehavior.LockCenter
        UserInputService.MouseIconEnabled = false
        
        showNotification("Free Camera Enabled", Color3.fromRGB(100, 255, 100))
        
        print("Free Camera: Enabled")
    else
        camera.CameraType = originalCameraType
        
        toggleButton.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
        toggleButton.Text = "FREE CAMERA"
        
        UserInputService.MouseBehavior = Enum.MouseBehavior.Default
        UserInputService.MouseIconEnabled = true
        
        showNotification("Free Camera Disabled", Color3.fromRGB(255, 100, 100))
        
        print("Free Camera: Disabled")
    end
end

-- Show notification message
function showNotification(message, color)
    local notification = Instance.new("TextLabel")
    notification.Name = "Notification"
    notification.Size = UDim2.new(0, 300, 0, 40)
    notification.Position = UDim2.new(0.5, -150, 0, 20)
    notification.AnchorPoint = Vector2.new(0.5, 0)
    notification.BackgroundColor3 = color
    notification.BackgroundTransparency = 0.2
    notification.Text = message
    notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    notification.TextSize = 16
    notification.Font = Enum.Font.GothamBold
    notification.ZIndex = 20
    notification.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = notification
    
    TweenService:Create(notification, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut), {
        BackgroundTransparency = 1,
        TextTransparency = 1
    }):Play()
    
    game:GetService("Debris"):AddItem(notification, 2)
end

-- Update camera position and rotation
function updateCamera(deltaTime)
    if not freeCameraEnabled then return end
    
    local inputVector = Vector3.new(0, 0, 0)
    local speed = cameraSpeed
    
    if UserInputService:IsKeyDown(Enum.KeyCode.W) then
        inputVector = inputVector + Vector3.new(0, 0, -1)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.S) then
        inputVector = inputVector + Vector3.new(0, 0, 1)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.A) then
        inputVector = inputVector + Vector3.new(-1, 0, 0)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.D) then
        inputVector = inputVector + Vector3.new(1, 0, 0)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.E) then
        inputVector = inputVector + Vector3.new(0, 1, 0)
    end
    if UserInputService:IsKeyDown(Enum.KeyCode.Q) then
        inputVector = inputVector + Vector3.new(0, -1, 0)
    end
    
    if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
        speed = fastCameraSpeed
    end
    
    local mouseDelta = UserInputService:GetMouseDelta()
    cameraRotation = Vector2.new(
        cameraRotation.X - mouseDelta.X * mouseSensitivity * 0.01,
        math.clamp(cameraRotation.Y - mouseDelta.Y * mouseSensitivity * 0.01, -math.pi/2 + 0.1, math.pi/2 - 0.1)
    )
    
    if inputVector.Magnitude > 0 then
        inputVector = inputVector.Unit
    end
    
    local movement = inputVector * speed * deltaTime
    local camCFrame = CFrame.fromEulerAnglesYXZ(cameraRotation.Y, cameraRotation.X, 0)
    movement = camCFrame:VectorToWorldSpace(movement)
    
    cameraPosition = cameraPosition + movement
    
    camera.CFrame = CFrame.new(cameraPosition) * camCFrame
end

-- Handle keyboard shortcuts
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.F5 then
        toggleFreeCamera()
    end
end)

-- Update camera every frame
RunService.RenderStepped:Connect(function(deltaTime)
    updateCamera(deltaTime)
end)

-- Initialize the script
if player then
    createUI()
    print("Free Camera script loaded successfully.")
    print("Press F5 or click the button to toggle free camera.")
    print("Controls: WASD - Move, Q/E - Up/Down, Shift - Speed boost, Mouse - Look around")
else
    Players.PlayerAdded:Wait()
    player = Players.LocalPlayer
    camera = workspace.CurrentCamera
    createUI()
end

-- Recreate UI when player respawns
player.CharacterAdded:Connect(function()
    wait(0.5)
    createUI()
end)
